<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shot clock</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'shotclock/css/style.css' %}" />
  </head>
  <body>
    <div class="grid-container">
      <div class="header">
        <h1 class="slogan">Let's play.</h1>

        <div class="title">
          <h2>A basketball shot clock</h2>
          <p>
            by
            <a href="https://www.aapomontin.com">Aapo Montin</a>
          </p>
        </div>
      </div>
      <div class="main-content">
        <h2>About</h2>

        <p>
          This is a simple shot clock application built with Django, Channels,
          and WebSockets. The project is hosted on an Oracle Cloud VM and the
          source code is available on
          <a href="https://github.com/apmnt/shotclock">GitHub</a>.
        </p>
        <p>
          The application allows you to create multiple games, each identified
          by a unique game ID. You can control the shot clock for each game via
          a control panel and display the countdown on a separate screen.
          Separation of controls and the view allows you to manage game state
          from one client, while showing the countdown on other clients.
        </p>
        <p>
          While having the ability to control the game from multiple clients,
          some latency is expected due to the nature of WebSockets and network
          conditions, especially as the app is hosted on Oracle Cloud in the
          Asia Pacific region.
        </p>

        <div class="game-section">
          <h2>Create a clock</h2>
          <p>
            Enter your clock identifier and use the links to access control or
            display:
          </p>
          <div class="game-input-section">
            <input
              type="text"
              id="gameIdInput"
              placeholder="Enter game ID (e.g., game2, torikoris)"
              value=""
            />
            <div class="links" style="display: inline-block">
              <a href="#" id="controlLink" class="control-link"
                >Control Panel</a
              >
              <a href="#" id="displayLink" class="display-link">Display</a>
            </div>
          </div>
        </div>

        <div class="game-section">
          <h2>API Endpoints</h2>
          <p>
            For developers - API endpoints for game state (replace "game1" with
            your game ID):
          </p>
          <ul>
            <li>
              <a href="{% url 'state_json' game_id='game1' %}">JSON State</a>
            </li>
            <li>
              <a href="{% url 'state_plain' game_id='game1' %}"
                >Plain Text State</a
              >
            </li>
            <li>
              <a href="{% url 'state_sse' game_id='game1' %}"
                >Server-Sent Events Stream</a
              >
            </li>
          </ul>
        </div>
      </div>
    </div>

    <script>
      function updateLinks() {
        const gameId =
          document.getElementById("gameIdInput").value.trim() || "your-game-id";
        const controlLink = document.getElementById("controlLink");
        const displayLink = document.getElementById("displayLink");

        // Update the href attributes with the current game ID
        controlLink.href = `{% url 'control' game_id='PLACEHOLDER' %}`.replace(
          "PLACEHOLDER",
          gameId
        );
        displayLink.href = `{% url 'display' game_id='PLACEHOLDER' %}`.replace(
          "PLACEHOLDER",
          gameId
        );
      }

      // Update links when the input changes
      document
        .getElementById("gameIdInput")
        .addEventListener("input", updateLinks);

      // Initialize links on page load
      updateLinks();
    </script>
  </body>
</html>
